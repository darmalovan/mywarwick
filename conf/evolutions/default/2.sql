# --- !Ups
CREATE TABLE NOTIFICATION (
  "ID" nvarchar2 (100) NOT NULL,
  "PROVIDER_ID" nvarchar2 (100) NOT NULL,
  "TYPE" nvarchar2 (100) NOT NULL,
  "TITLE" clob NOT NULL,
  "TEXT" clob NOT NULL,
  "REPLACED_BY_ID" nvarchar2 (100),
  "GENERATED_AT" TIMESTAMP (6) NOT NULL,
  "CREATED_AT" TIMESTAMP (6) NOT NULL,
  CONSTRAINT "NOTIFICATION_PK" PRIMARY KEY ("ID")
);

CREATE TABLE NOTIFICATION_SCOPE (
  "NOTIFICATION_ID" nvarchar2 (100) NOT NULL,
  "ID" nvarchar2 (100) NOT NULL,
  "NAME" nvarchar2 (255) NOT NULL,
  "VALUE" nvarchar2 (255) NOT NULL,
  "CREATED_AT" TIMESTAMP (6) NOT NULL,
  CONSTRAINT "NOTIFICATION_SCOPE_PK" PRIMARY KEY ("NOTIFICATION_ID", "ID"),
  CONSTRAINT "NOTIFICATION_SCOPE_FK" FOREIGN KEY ("NOTIFICATION_ID") REFERENCES NOTIFICATION("ID")
);

CREATE TABLE NOTIFICATION_RECIPIENT (
  "NOTIFICATION_ID" nvarchar2 (100) NOT NULL,
  "USERCODE" nvarchar2 (10) NOT NULL,
  "CREATED_AT" TIMESTAMP (6) NOT NULL,
  "SENT_AT" TIMESTAMP (6),
  "SEEN_AT" TIMESTAMP (6),
  "DISMISSED_AT" TIMESTAMP (6),
  CONSTRAINT "NOTIFICATION_DELIVERIES_PK" PRIMARY KEY ("NOTIFICATION_ID", "USERCODE"),
  CONSTRAINT "NOTIFICATION_DELIVERIES_FK" FOREIGN KEY ("NOTIFICATION_ID") REFERENCES NOTIFICATION("ID")
);


# --- !Downs
ALTER TABLE NOTIFICATION_SCOPE DROP CONSTRAINT NOTIFICATION_SCOPE_FK;
ALTER TABLE NOTIFICATION_RECIPIENT DROP CONSTRAINT NOTIFICATION_DELIVERIES_FK;

DROP TABLE NOTIFICATION_SCOPE;
DROP TABLE NOTIFICATION_RECIPIENT;
DROP TABLE NOTIFICATION;
